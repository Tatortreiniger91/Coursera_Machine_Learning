PREDICT <- function(Theta1, Theta2, X){
#PREDICT Predict the label of an input given a trained neural network
#   p = PREDICT(Theta1, Theta2, X) outputs the predicted label of X given the
#   trained weights of a neural network (Theta1, Theta2)

# Useful values
m <- dim(X)[1]
num_labels <- dim(Theta2)[1]

# You need to return the following variables correctly 
p <- matrix(0, dim(X)[1])

# ====================== YOUR CODE HERE ======================
# Instructions: Complete the following code to make predictions using
#               your learned neural network. You should set p to a 
#               vector containing labels between 1 to num_labels.
#
# Hint: The max function might come in useful. In particular, the max
#       function can also return the index of the max element, for more
#       information see 'help max'. If your examples are in rows, then, you
#       can use max(A, [], 2) to obtain the max for each row.
#

X <- cbind(rep(1, m), X)
t1 <- g(X %*% t(Theta1))
t1 <- cbind(rep(1, m), t1)
t2 <- g(t1 %*% t(Theta2))

p <- apply(t2, 1, which.max)

}